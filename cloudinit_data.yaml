neerali_systems_layout:
  cloud_init: |
    #cloud-config
    ssh_pwauth: true
    disable_root: false

    groups:
      - cephuser

    users:
      - name: cephuser
        primary-group: cephuser
        sudo: ALL=(ALL) NOPASSWD:ALL
        shell: /bin/bash
        ssh-authorized-keys:
          - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDq5TDCTnfr5ogch0GrpbukGNplGkd9iiFPYh91xJ5fhoC9aKUIIHCREZNGmO/ESoZAIJlyoqx/j7Nj80CcCsDTZTHs7q7b2224Ki+9IubTaTQWGyYy85KHthPkXkyoatOkkJFmcKTTYEp2/EhKMS04tPmjR8m3nh6M6g2eKnIEjUMZ5+NxJmIKDlZJw3M0+4kp47oXNgaZQ9AhVuRuu0aWPambiWW5tp3gSnT2fE9le5KgbSurCq+PPLkfyzqSHrjavcCsnp8apmUYS2v/GksqXwpVO3335QMou8eK4jRQhc4g6n9uhH4/yyjMbiYEU4L3rLc0ljlXXsg63L/jrwimHJgo19yKUEehjI3c4wdXwoGUlV/1Ewa2/IULEAiOGq80p107Xn1Krd8k5EmKWZdIu3KyDe3rriI9b/YvHJRm4i4IVqPs8Eqm3zOlD2I9PsfzI3aKv18iskbkFZKgKwu0tRSbmuGfBUcm/A9zfa07DTxksSgT8KRyLziudjxU3Yy1ihXBW40RaGSbGrDSkYLBrWUDxvG5Jid3v1UO8D7Lxik1z0ZKan7kYD5lCBjtAFKxKNlPAKCzlKAI4otbG3yMRd9BZFGVQGuRkbhE2kz5nvjmY10DFz5iJM8y/aSeesAXVuNjFMb8KsuilcRopiGqdweQS9R/yvNpD2DtimlvCw== venkateshravula@corpha2-int.rdu.redhat.com

    chpasswd:
      users:
        - name: cephuser
          password: pass123
        - name: root
          password: passwd
      expire: false

    runcmd:
      - sed -i -e 's/^Defaults\s\+requiretty/# \0/' /etc/sudoers
      - subscription-manager clean
      - hostnamectl set-hostname $(hostname -s)
      - sed -i -e 's/#PermitRootLogin .*/PermitRootLogin yes/' /etc/ssh/sshd_config
      - sed -i -e 's/#PasswordAuthentication .*/PasswordAuthentication yes/' /etc/ssh/sshd_config
      - systemctl restart sshd
      - curl -m 120 -o /etc/pki/ca-trust/source/anchors/ceph-qe-ca.pem http://magna002.ceph.redhat.com/cephci-jenkins/.cephqe-ca.pem
      - curl -m 120 -k -o /etc/pki/ca-trust/source/anchors/RH-IT-Root-CA.crt https://certs.corp.redhat.com/certs/2015-IT-Root-CA.pem
      - update-ca-trust
      - yum-config-manager --add-repo http://magna002.ceph.redhat.com/cephci-jenkins/repos/9/lab-extras.repo
      - yum clean metadata
      - yum clean all
      - echo "net.core.default_qdisc=netem" > /etc/sysctl.d/1000-qdisc.conf
      - timedatectl set-timezone Etc/UTC
      - touch /ceph-qa-ready

    final_message: "Ready for ceph qa testing"
